---

## Disable transmission of rsyslog to logstash for the application
- hosts: Agents
  remote_user: root
  vars_files:
    - vars/main.yml

  tasks:
   - name: Disable Transmission
     shell: mv /etc/rsyslog.d/{{ application }}.conf \
       /etc/rsyslog.d/{{ application }}.conf.locked
     notify: Restart Rsyslog
     
  handlers:
   - include: handlers/handlers.yml
   
  # include not working with thie version yet
  # See this bug : https://github.com/ansible/ansible/issues/13485
   - name: Restart Rsyslog
     service: name=rsyslog state=restarted

