---

- name: Add Ansible repository
  apt_repository: repo=ppa:ansible/ansible update_cache=yes
  tags:
    - only-controller
  
- name: Install software-properties-common
  apt: pkg=software-properties-common update_cache=false
  tags:
    - only-controller
  
- name: Install Ansible
  apt: pkg=ansible update_cache=false
  tags:
    - only-controller

- name: Create SSH Key 
  user: generate_ssh_key=yes name={{ ansible_ssh_user }}
    
- name: Create OpenBACH repository
  file: path=/opt/openbach state=directory mode=0755
    
- name: Copy the SSH Key to OpenBACH repository
  copy: src=/home/{{ ansible_ssh_user }}/.ssh/id_rsa.pub dest=/opt/openbach/ remote_src=True

